<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script type="module">
      import products from "./products.js";

      document.addEventListener("DOMContentLoaded", async () => {
        console.log("DOM ready!");

        const p1 = products[0];
        console.log(p1);

        // Destructure
        //let productID = p1.productID;

        let { productID, productName } = p1;
        // String interpolation (backtic), alt+96
        console.log(`${productID}, ${productName}`);

        // Rest
        let [a, b, c, ...d] = products;
        console.log(products.length);
        console.log(a);
        console.log(d);

        // Spread
        console.clear();
        console.log(products);
        console.log(a, b, c);
        console.log(...products);

        console.clear();

        for (let p of products) {
          console.log(`${p.productID}, ${p.productName}`);
        }

        products.forEach(function (p) {
          console.log(`${p.productID}, ${p.productName}`);
        });

        // Arrow function
        products.forEach((p) => {
          // this
          console.log(`${p.productID}, ${p.productName}`);
        });

        // let t = "abc '123' xyz";
        const ul = document.getElementById("results");

        // if (ul) {
        //   products.forEach((p) => {
        //     const li = document.createElement("li");
        //     li.innerText = `${p.productID}, ${p.productName}`;
        //     ul.appendChild(li);
        //   });
        // }

        console.clear();
        // Async, callbacks
        // Promises, async/await

        const trabajo = new Promise((resolve, reject) => {
          // Aquí se hace el trabajo
          setTimeout(() => {
            try {
              //console.log("Trabajo terminado");
              resolve("Trabajo terminado");
            } catch (error) {
              reject("Trabajo doy ERROR");
            }
          }, 2000);
        });

        // trabajo.then((r) => console.log(r)).
        // catch((e) => console.error(e));

        try {
          let result = await trabajo;
          console.log(result);
        } catch (error) {
          console.error(error);
        }

        // const f = async () => {
        //   try {
        //     let result = await trabajo;
        //     console.log(result);
        //   } catch (error) {
        //     console.error(error);
        //   }
        // };

        // f()

        const response = await fetch("https://swapi.dev/api/people/?search=lu");
        if (response.ok) {
          const data = await response.json();
          console.log(data);

          if (ul) {
            data.results.forEach((p) => {
              console.log(p.name);
              const li = document.createElement("li");
              li.innerText = `${p.name}, ${p.height}`;
              ul.appendChild(li);
            });
          }
        } else {
          console.error("Error en la petición");
        }
      });
    </script>
    <ul id="results"></ul>
  </body>
</html>
